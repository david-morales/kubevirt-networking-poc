namespace: kubevirt-networking-poc

app:
  image:
    repository: image-registry.openshift-image-registry.svc:5000/kubevirt-networking-poc/kubevirt-networking-poc
    tag: latest
  service:
    type: LoadBalancer
    port: 8080

vm:
  imageName: kubevirt/fedora-cloud-container-disk-demo
  imageTag: v0.36.4
  cloudInitData: |
    #cloud-config
    users:
      - default
      - name: neo
        plain_text_passwd: 'neo'
        lock_passwd: false
        groups: users, admin
        sudo: ALL=(ALL) NOPASSWD:ALL
    package_upgrade: true
    packages:
      - mongodb-server
    write_files:
      - path: /etc/systemd/system/mongodb.service
        content: |
          [Unit]
          Description=MongoDB Database Service
          Wants=network-online.target
          After=network-online.target

          [Service]
          User=mongod
          Group=mongod
          ExecStart=/usr/bin/mongod -f /etc/mongod.conf
          ExecReload=/bin/kill -HUP $MAINPID
          KillMode=process
          Restart=on-failure

          [Install]
          WantedBy=multi-user.target
    runcmd:
      - systemctl daemon-reload
      - systemctl enable --now mongodb.service
      - sleep 10
      - mongo --eval 'db.names.insert({"name": "John Doe"})' demo
